(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[4522,7212,9030],{54021:function(e,i,t){"use strict";t.r(i),t.d(i,{AUTH_RESULT_REASON:function(){return y.$9},BIEvents:function(){return T},INTERACTIONS:function(){return y.SE},PrivacyStatus:function(){return y.iY},SiteMembersApiSymbol:function(){return E.n9},isLoginAcceptableError:function(){return I.Y2},isSignupAcceptableError:function(){return I.fJ},memberDetailsFromDTO:function(){return I.Ky},page:function(){return B},site:function(){return F}});var o=t(56510),a=t(25259),n=t(14439),s=t(21980),r=t(55437),l=t(32114),c=t(53891),u=t(54164),d=t(2922),g=t(24888),m=t(89534);var p=t(52192),h=t(61885),b=t(31619),v=t(75471),C=t(51978),S=t(19378),w=t(51968),f=t(18037),y=t(6504),D=t(63805),E=t(50997);class P{constructor(e,i,t,o){this.propsStore=e,this.structureApi=i,this.siteScrollBlocker=t,this.browserWindow=o}async displayDialog(e,i,t,o={}){const a=async()=>{(0,p.yF)(this.browserWindow)||(this.activeElementBeforeShowDialog=this.browserWindow.document.activeElement);const o=(0,f.uniqueId)(E.rj);this.propsStore.update({[o]:Object.assign(Object.assign({},i),t)}),(0,D.U)(),await this.structureApi.addComponentToDynamicStructure(o,{componentType:e,components:[]}),this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId)),this.siteScrollBlocker.setSiteScrollingBlocked(!0,o),this.currentCompId=o},{shouldWaitForAppDidMount:n,registerToAppDidMount:s}=o;n&&s?s(a):await a()}hideDialog(){var e;this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId),(0,D.i)()),this.currentCompId=void 0,(0,p.yF)(this.browserWindow)||(null===(e=this.activeElementBeforeShowDialog)||void 0===e||e.focus(),this.activeElementBeforeShowDialog=null)}}var I=t(13039),k=t(56334);const T=({sessionManager:e,businessLogger:i,wixBiSession:t,viewMode:o,language:a})=>{const n=(i,n)=>({biToken:t.msId,context:i,ts:L(t),viewmode:o,visitor_id:e.getVisitorId(),site_member_id:e.getSiteMemberId(),vsi:t.viewerSessionId,site_settings_lng:a.siteLanguage,browser_lng:a.userLanguage,lng_mismatch:a.siteLanguage!==a.userLanguage,layout:n});return{loginOrSignUpDialogLoaded:(e,t="fullscreen")=>{i.logger.log(Object.assign({src:5,evid:658},n(e,t)),{endpoint:"site-members"})},closingDialog:(e,t="fullscreen")=>{i.logger.log(Object.assign({src:5,evid:602,form_type:"default"},n(e,t)),{endpoint:"site-members"})},emailAuthSubmitClicked:(e,t)=>{i.logger.log(Object.assign({src:5,evid:603,form_type:"default"},n(e,t)),{endpoint:"site-members"})},siteMembersFeatureLoaded:()=>{i.logger.log(Object.assign({src:5,evid:698},n()),{endpoint:"site-members"})},siteMembersSdkFeatureLoaded:()=>{i.logger.log(Object.assign({src:5,evid:699},n()),{endpoint:"site-members"})},siteMembersEmailConfirmationNewMembersModalLoad:()=>{i.logger.log(Object.assign({src:5,evid:1809},n()),{endpoint:"site-members"})},siteMembersEmailConfirmationSendCodeClick:()=>{i.logger.log(Object.assign({src:5,evid:1810},n()),{endpoint:"site-members"})},siteMembersEmailConfirmationOnResendCodeClick:()=>{i.logger.log(Object.assign({src:5,evid:1811},n()),{endpoint:"site-members"})}}},L=e=>{const i=e.initialTimestamp||0;return Date.now()-i},A={isCloseable:!0,returnPages:!1};class R{constructor(e,i){this.shouldRunCustomPopupCloseCallback=!0,this.popups=e,this.onReset=i,this.config=A}async openPopupPage(e,i){var t;const o=this.shouldRunCustomPopupCloseCallback;this.preventCustomPopupCloseCallback(),await(null===(t=this.popups)||void 0===t?void 0:t.openPopupPage(e,(()=>{this.shouldRunCustomPopupCloseCallback&&(this.rejectAuthenticationRequest(),i&&i())}))),this.shouldRunCustomPopupCloseCallback=o}preventCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!1}allowCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!0}assignRequestAuthenticationRejection(e){this.requestAuthenticationRejectInstance=this.requestAuthenticationRejectInstance||e}assignRequestAuthenticationResolveInstance(e){this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}assignRequestAuthenticationPromise(e,i){this.requestAuthenticationRejectInstance=this.requestAuthenticationRejectInstance||i,this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}rejectAuthenticationRequest(){this.requestAuthenticationRejectInstance&&(this.requestAuthenticationRejectInstance(y.$9.CANCELED),this.reset())}resolveAuthenticationRequest(e){this.requestAuthenticationRejectInstance&&(this.requestAuthenticationResolveInstance(e),this.reset())}setConfig({isCloseable:e=!0,returnPages:i=!1}){this.config={isCloseable:e,returnPages:i}}reset(){var e;null===(e=this.onReset)||void 0===e||e.call(this),this.requestAuthenticationRejectInstance=void 0,this.requestAuthenticationResolveInstance=void 0,this.config=A}}const O=(e,i,t)=>{document.cookie=`${e}=;max-age=0`,document.cookie=`${e}=;max-age=0;path=${i}`,document.cookie=`${e}=;domain=${t};max-age=0`,document.cookie=`${e}=;domain=${t};max-age=0;path=${i}`},_=(0,o.ff)([(0,o.t6)(a.R9,E.u2),(0,o.t6)(a.jC,E.u2),(0,o.t6)(a.Wf,E.u2),n.U,s.EE,s.Zr,b.Xb,r.xP,r.QZ,s.bk,s.ZQ,v.F0,C.x,l.v,v.Iz,c.$,u.s,(0,o.jt)(S.r_),(0,o.jt)(w.I),d.jj,g.O,m.C,(0,o.jt)(k.I)],((e,i,t,o,a,n,s,r,l,c,u,d,g,m,b,v,C,S,w={trackEvent:()=>0},D,E,k,L)=>{var A,_,M,N,U;const $=(()=>{const e={},i={setItemCssOverrides:(i,t,o)=>{const a=o.document.querySelector(t);a&&(Object.assign(a.style,i),e[t]=(e[t]||[]).concat(Object.keys(i)))},clearItemCssOverrides:(i,t)=>{const o=e[i];if(!o)return;const a=new Set([...o]),n=t.document.querySelector(i);n&&(a.forEach((e=>n.style.removeProperty(e))),""===n.getAttribute("style")&&n.removeAttribute("style")),delete e[i]},clearAllItemsCssOverrides:t=>{Object.keys(e).forEach((e=>{i.clearItemCssOverrides(e,t)}))}};return i})(),{shouldLoadInvisibleCaptcha:j,isCommunityInstalled:q,collectionExposure:F,protectedHomepage:B,smSessionCookie:x,memberInfoAppId:W,smcollectionId:V,isTemplate:G}=e;let{sm_efCookie:H}=e;const z="WixInternal"===F,K=s.getUserSession(),Y=s.getAppInstanceByAppDefId("22bef345-3c5b-4c18-b782-74d4085112ff"),J=()=>(0,I.OP)(s),{smSettings:Q,tpaApplicationIds:X,policyLinks:Z}=i,ee=W&&X[W],{metaSiteId:ie,externalBaseUrl:te,siteId:oe,siteRevision:ae}=n.site,ne=n.requestUrl,se=n.viewMode,re=null!==(_=null===(A=n.anywhereConfig)||void 0===A?void 0:A.siteId)&&void 0!==_?_:oe,le=null!==(N=null===(M=n.anywhereConfig)||void 0===M?void 0:M.revision)&&void 0!==N?N:ae,ce=-1!==y.F0.findIndex((e=>{var i,t;return null===(t=null===(i=null==u?void 0:u.navigator)||void 0===i?void 0:i.userAgent)||void 0===t?void 0:t.includes(e)})),ue=!ce,de=!ce,ge=`/_api/wix-sm-webapp/tokens/verify/${ie}/${re}`,me=`${te.replace(/\/$/,"")}/api/wix-sm/v1/authorize/${re}/pages`,pe=`/_api/wix-sm-webapp/tokens/logout/${ie}`,he=`/_api/wix-sm-webapp/member/changePasswordWithMailToken?metaSiteId=${ie}&collectionId=${V}`,be=`/_api/wix-sm-webapp/social/token/handle?metaSiteId=${ie}&collectionId=${V}`,ve=Q.smFirstDialogLogin?"login":"signup",{socialLoginFacebookEnabled:Ce,socialLoginGoogleEnabled:Se,termsOfUse:we,privacyPolicy:fe,codeOfConduct:ye,customSignUpPageId:De,customSignInPageId:Ee}=Q,Pe=null===(U=Q.joinCommunityCheckedByDefault)||void 0===U||U;let{smToken:Ie}=e,ke={},Te=x,Le=null,Ae=!1;const Re=e=>{Le=e},Oe=()=>({registerToAppDidMount:Re,shouldWaitForAppDidMount:!Ae}),_e={},Me={},Ne=e=>Promise.all(Object.entries(e).map((async([e,i])=>{try{if("$$$timeout$$$"===await Promise.race([i(),(0,I._v)(3e3).then((()=>"$$$timeout$$$"))]))throw new Error(`callback ${e} timed out`)}catch(e){a.captureError(e,{tags:{feature:"site-members"}})}}))),Ue=T({sessionManager:s,businessLogger:v,wixBiSession:C,viewMode:null==se?void 0:se.toUpperCase(),language:c});Ue.siteMembersFeatureLoaded();const $e={},je=(0,I.Qn)(o,{credentials:"same-origin",headers:{accept:"application/json","x-wix-site-revision":`${le}`,"x-wix-client-artifact-id":"thunderbolt"}},n.requestUrl),qe=((e,i,t,o)=>new P(e,i,t,o))(r,l,g,u),Fe=new R(S,(()=>{j&&E["specs.thunderbolt.shouldLoadInvisibleCaptcha"]&&$.setItemCssOverrides({visibility:"hidden"},".grecaptcha-badge",u)})),Be=null==L?void 0:L.getBsi(),xe=Be?Be.split("|")[0]:"00000000-0000-0000-0000-000000000000",We={appDidMount(){Le&&Le(),Ae=!0},async login(e,i,t,o=!1){w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:"Wix"}});try{const a=await We.performLogin(e,i,t),n=await We.handleLoginResponse(a,o);return w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:"Wix"}}),n}catch(e){throw w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:"Wix"}}),e}},async performLogin(e,i,t){var o;const a=await je("/_api/wix-sm-webapp/v1/auth/login",{method:"POST",headers:{"Content-Type":"application/json",authorization:Y||""},body:JSON.stringify({email:e,password:i,recaptchaToken:null==t?void 0:t.recaptchaToken,invisibleRecaptchaToken:null==t?void 0:t.invisibleRecaptchaToken})});return{member:a.member,token:null===(o=null==a?void 0:a.session)||void 0===o?void 0:o.token}},async handleOauthToken(e,i,t,o,n=!1){const r=s.getVisitorId();a.interactionStarted(y.SE.SOCIAL_APP_LOGIN),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:i}});try{const{payload:s}=await je(be,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svSession:K,visitorId:r,token:e,provider:i,mode:t,lang:c.userLanguage,privacyStatus:o})});let l,u;a.interactionEnded(y.SE.SOCIAL_APP_LOGIN),s.smSession&&(u=s.smSession.siteMemberDto,l=s.smSession.sessionToken),u=s.siteMemberDto;const d=(0,I.Ky)(u),g=await We.handleLoginResponse({member:d,token:l},n);return w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:i}}),g}catch(e){throw w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:i}}),e}},async handleSocialLoginResponse(e,i,t=!1){let o,n;a.interactionStarted(y.SE.SOCIAL_APP_LOGIN),a.interactionEnded(y.SE.SOCIAL_APP_LOGIN),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:i}}),e.smSession&&(n=e.smSession.siteMemberDto,o=e.smSession.sessionToken),n=e.siteMemberDto;const s=(0,I.Ky)(n),r=await We.handleLoginResponse({member:s,token:o},t);return w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:i}}),r},async handleLoginResponse({token:e,member:i},t=!1){const o=i.emailVerified;if(e||o||"ACTIVE"!==i.status){if(e){const o=await We.applySessionToken(e,i,t);return Object.assign({sessionToken:e,member:i},t?{pages:o}:{})}return We.showAdminApprovalDialog(i.loginEmail,"login")}return We.showConfirmationEmailDialog(i.id)},async promptLogin(e,i,t){var o,a,n,s;void 0===e&&(e={}),void 0===i&&(i=null===(a=null===(o=Fe.config)||void 0===o?void 0:o.isCloseable)||void 0===a||a),void 0===t&&(t=null!==(s=null===(n=Fe.config)||void 0===n?void 0:n.returnPages)&&void 0!==s&&s);const{mode:r,modal:l}=e,d=null!=r?r:ve,g=l?"popup":"fullscreen";if(G){const e=await m();return await We.showNotificationDialog(e("siteMembersTranslations","siteMembersTranslations_TEMPLATE_NOTIFICATION_TITLE","Demo Mode"),e("siteMembersTranslations","siteMembersTranslations_TEMPLATE_NOTIFICATION_MESSAGE","To make this template yours, start editing it."),e("siteMembersTranslations","SMContainer_OK","OK")),Promise.reject(y.$9.CANCELED)}return(0,I.cW)(u,c.userLanguage,j&&E["specs.thunderbolt.shouldLoadInvisibleCaptcha"]?y.mz:"explicit"),j&&E["specs.thunderbolt.shouldLoadInvisibleCaptcha"]&&setTimeout((()=>{$.setItemCssOverrides({visibility:"visible","z-index":"var(--portals-z-index)"},".grecaptcha-badge",u)}),1e3),"login"===d?We.showLoginDialog(i,g,t):We.showSignUpDialog(i,g,t)},promptForgotPassword:(e=!0)=>new Promise(((i,t)=>{Fe.assignRequestAuthenticationPromise(i,t);const o={isCloseable:e,directionByLanguage:c.directionByLanguage},a={onCloseDialogCallback(){Ue.closingDialog("RequestResetPassword"),qe.hideDialog(),Fe.rejectAuthenticationRequest()},onSubmitCallback:e=>We.sendForgotPasswordMail(e).then((async()=>{const e=await m(),t=()=>{Fe.resolveAuthenticationRequest(),i()};We.showNotificationDialog(e("siteMembersTranslations","siteMembersTranslations_RESET_PASSWORD_CHECKEMAIL_TITLE","Please Check Your Email"),e("siteMembersTranslations","siteMembersTranslations_RESET_PASSWORD_CHECKEMAIL_TEXT","We\u2019ve emailed you a link to reset your password."),e("siteMembersTranslations","siteMembersTranslations_Reset_Password_OK","Got It"),t,t)}))},n=E["specs.thunderbolt.smModalsShouldWaitForAppDidMount"]?Oe():{};qe.displayDialog("RequestPasswordResetDialog",o,a,n)})),async requestAuthentication(e={}){if(Te)return{success:!0,token:Te,reason:y.$9.ALREADY_LOGGED_IN};try{const i=!B,{sessionToken:t}=await We.promptLogin(e,i);return{success:!0,token:t,reason:y.$9.SUCCESS}}catch(e){return{success:!1,reason:e}}},async requestAuthorizedPages(e={}){if(Ie){return{success:!0,pages:await We.authorizeMemberPagesBySignedInstance(Ie)}}try{const i=!B;Fe.setConfig({isCloseable:i,returnPages:!0});const t=await We.promptLogin(e,i,!0);return Fe.reset(),{success:!0,pages:t.pages}}catch(e){return{success:!1,reason:e}}},async applySessionToken(e,i,t=!1){a.interactionStarted(y.SE.VERIFY_TOKEN);const{payload:o}=await je(ge,{method:"POST",body:`token=${e}`});if(a.interactionEnded(y.SE.VERIFY_TOKEN),await s.loadNewSession({reason:"memberLogin"}),Ie=s.getSmToken(),Te=e,ke=null!=i?i:await We.getMemberDetails(),await Ne(_e),t)return o.pages},async authorizeMemberPagesByCookie(){const e=(0,p.yF)(u)?{headers:{cookie:`smSession=${x}`}}:void 0,{authorizedPages:i}=await je(me,e);return i},async authorizeMemberPagesByToken(e){if(e===x)return this.authorizeMemberPagesByCookie();const{payload:i}=await je(ge,{method:"POST",body:`token=${e}`}),{pages:t}=i;return t},async authorizeMemberPagesBySignedInstance(e){const i={headers:{authorization:e}},{authorizedPages:t}=await je(me,i);return t},async getMemberDetails(e=!1){if(ke.id&&!e)return ke;if(Ie){const i=`/_api/wix-sm-webapp/member/${Ie}?collectionId=${V}&metaSiteId=${ie}`,{payload:t}=await je(i);return ke=(0,I.Ky)(t),e&&await Promise.all(Object.values($e).map((async e=>{try{await e()}catch(e){a.captureError(e,{tags:{feature:"site-members"}})}}))),ke}return null},async register(e,i,t,o,n,s,r,l,c){s=null!=s&&s;try{a.interactionStarted(y.SE.CODE_SIGNUP),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Submit",eventLabel:"Wix"}});const u={email:e,password:i,profilePrivacyStatus:o,contactInfo:(0,I.t1)(t||{}),defaultFlow:n,recaptchaToken:r,invisibleRecaptchaToken:l,emailVerification:c},{member:d,session:g}=await je("/_api/wix-sm-webapp/v1/auth/signup",{method:"POST",headers:{"Content-Type":"application/json",authorization:Y||""},body:JSON.stringify(u)}),m=d.emailVerified,p=null==g?void 0:g.token,h="ACTIVE"===(null==d?void 0:d.status)?"ACTIVE":"PENDING";if(p||m||"ACTIVE"!==d.status){if(n&&"APPLICANT"===(null==d?void 0:d.status)||!p)return a.interactionEnded(y.SE.CODE_SIGNUP),We.showAdminApprovalDialog(e,"signup");{const e=await We.applySessionToken(p,d,s);return a.interactionEnded(y.SE.CODE_SIGNUP),w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Success",eventLabel:"Wix"}}),w.trackEvent({eventName:"CompleteRegistration",params:{origin:"Site members",method:"Wix"}}),Object.assign({member:d,status:h,sessionToken:p},s&&e?{pages:e}:{})}}return a.interactionEnded(y.SE.CODE_SIGNUP),We.showConfirmationEmailDialog(d.id)}catch(s){if(w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Failure",eventLabel:"Wix"}}),(0,I.yQ)(s)){a.interactionStarted(y.SE.VERIFICATION_CODE);const{details:c}=s,{applicationError:u}=c,{data:d}=u,g={email:e,password:i,profilePrivacyStatus:o,contactInfo:t,defaultFlow:n,recaptchaToken:r,invisibleRecaptchaToken:l,emailVerification:{verificationId:null==d?void 0:d.verificationId,otp:""}};return We.showVerificationCodeDialog(g)}throw(0,I.fJ)(s)&&a.interactionEnded(y.SE.CODE_SIGNUP),s}},async sendForgotPasswordMail(e){a.interactionStarted(y.SE.RESET_PASSWORD);const i=c.userLanguage,t=encodeURIComponent(ne),o=encodeURIComponent(e);await je("/_api/wix-sm-webapp/member/sendForgotPasswordMail",{method:"POST",body:`returnUrl=${t}&collectionId=${V}&metaSiteId=${ie}&lang=${i}&email=${o}`}),a.interactionEnded(y.SE.RESET_PASSWORD)},async sendSetPasswordEmail(e,i){const t=await je("/_api/wix-sm-webapp/members/v1/auth/members/send-set-password-email",{method:"POST",headers:{"Content-Type":"application/json",authorization:Y||""},body:JSON.stringify(Object.assign({email:e},(null==i?void 0:i.hideIgnoreMessage)?{hideIgnoreMessage:i.hideIgnoreMessage}:{}))});return!!(null==t?void 0:t.accepted)},async changePassword(e,i){const t=encodeURIComponent(e);await je(he,{method:"POST",body:`newPassword=${t}&forgotPasswordToken=${i}`})},async resendEmailVerification(e){await je(`/_api/wix-sm-webapp/tokens/email/resend/${e}`)},async logout(e){if(Ie){if(await je(pe,{method:"POST"}).catch((()=>{w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log out failed"}})})),await Ne(Me),e){const i=`./${e.replace(/^\//,"")}`;await d.navigate(i)}(0,p.yF)(u)||u.document.location.reload()}},registerToUserLogin:(e,i=(0,f.uniqueId)("callback"))=>(_e[i]=e,i),unRegisterToUserLogin(e){delete _e[e]},registerToMemberLogout(e){const i=(0,f.uniqueId)("logout_callback");return Me[i]=e,i},unRegisterToMemberLogout(e){delete Me[e]},registerToMemberDetailsRefresh(e){const i=(0,f.uniqueId)("mdrcb");return $e[i]=e,i},unRegisterToMemberDetailsRefresh(e){delete $e[e]},async showWelcomeDialog(e=!0){const i={isCloseable:e},t=b.getParsedUrl(),o={onCloseDialogCallback(){Ue.closingDialog("WelcomeDialog");const e=new URL(n.requestUrl).hostname,i=0===e.indexOf("www")?e.substr(3):e;O("sm_ef","/",i),H="",qe.hideDialog(),d.navigate(t.href)},onSubmitCallback(){const e=new URL(n.requestUrl).hostname,i=0===e.indexOf("www")?e.substr(3):e;O("sm_ef","/",i),H="",qe.hideDialog(),ee&&d.navigate("./account/my-account"),d.navigate(t.href)}};a.interactionStarted(y.SE.WELCOME_DIALOG),a.interactionEnded(y.SE.WELCOME_DIALOG),qe.displayDialog("WelcomeDialog",i,o)},async showNoPermissionsToPageDialog(e){const i={onCloseDialogCallback(){qe.hideDialog(),e&&e()},onSwitchAccountLinkClick(){We.logout()}};qe.displayDialog("NoPermissionsToPageDialog",{},i)},async showResetPasswordDialog(e){const i={isCloseable:!0,isTermsOfUseNeeded:!(!(null==we?void 0:we.enabled)||!Z.termsOfUse),isPrivacyPolicyNeeded:!(!(null==fe?void 0:fe.enabled)||!Z.privacyPolicy),termsOfUseLink:Z.termsOfUse,privacyPolicyLink:Z.privacyPolicy,directionByLanguage:c.directionByLanguage},t={onCloseDialogCallback(){Ue.closingDialog("ResetPasswordDialog");const e=b.getParsedUrl();e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),b.pushUrlState(e),qe.hideDialog(),d.navigate(e.href)},async onSubmitCallback(t){const o=await m();try{await We.changePassword(t,e),We.showNotificationDialog(o("siteMembersTranslations","siteMembersTranslations_Reset_Password_Sucess_Title","Your password has been changed."),"",o("siteMembersTranslations","SMContainer_OK","OK"),(async()=>{const e=b.getParsedUrl();e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),b.pushUrlState(e),await We.showLoginDialog(),d.navigate(e.href)}))}catch(e){if(-19972!==e)throw e;We.showNotificationDialog(o("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_TITLE","Your link to create a new password has expired"),o("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_TEXT","To continue, resend a new link to your email."),o("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_OK","Resend Link"),(()=>We.promptForgotPassword(i.isCloseable).then((()=>{const e=b.getParsedUrl();d.navigate(e.href)}))))}}};qe.displayDialog("ResetPasswordDialog",i,t,Oe())},showLoginDialog:async(e=!0,i="fullscreen",t=!1)=>Ee&&(null==S?void 0:S.isPopupPage(Ee))?We.showCustomAuthenticationDialog(Ee,t):new Promise((async(o,n)=>{Fe.assignRequestAuthenticationPromise(o,n);const s={bsi:xe,displayMode:i,language:c.userLanguage,directionByLanguage:c.directionByLanguage,isCloseable:e,smCollectionId:V,svSession:K,biVisitorId:J(),metaSiteId:ie,isSocialLoginGoogleEnabled:Se,isSocialLoginFacebookEnabled:!z&&Ce,isEmailLoginEnabled:!z,shouldForceCaptchaVerification:"Enabled"===E["specs.ShouldForceCaptchaVerificationOnLoginSpec"],isSocialAuthSupported:ue,shouldUseInvisibleCaptcha:E["specs.thunderbolt.useInvisibleCaptcha"]},r={onCloseDialogCallback(){qe.hideDialog(),Ue.closingDialog("MemberLoginDialog",i),Fe.rejectAuthenticationRequest()},submit:(e,n,s)=>(a.interactionStarted(y.SE.DEFAULT_LOGIN),Ue.emailAuthSubmitClicked("MemberLoginDialog",i),We.login(e,n,s,t).then((e=>{a.interactionEnded(y.SE.DEFAULT_LOGIN),qe.hideDialog(),o(e)})).catch((e=>{throw(0,I.Y2)(e)&&a.interactionEnded(y.SE.DEFAULT_LOGIN),e}))),onForgetYourPasswordClick(){We.promptForgotPassword(e)},onSwitchDialogLinkClick(){We.showSignUpDialog(e,i,t).then(o,(()=>{Fe.rejectAuthenticationRequest()}))},onTokenMessage(e,i,a=!1){let n;return q&&(n=a?"PUBLIC":"PRIVATE"),We.handleOauthToken(e,i,"memberLoginDialog",n,t).then((e=>{qe.hideDialog(),o(e)}))},onBackendSocialLogin:(e,i)=>We.handleSocialLoginResponse(e,i,t).then((e=>{qe.hideDialog(),o(e)})),getHostReadyPayload:()=>({visitorId:J(),svSession:K}),openCaptcha:(0,h.yT)({captcha:k,userLanguage:c.userLanguage})};Ue.loginOrSignUpDialogLoaded("MemberLoginDialog",i),await qe.displayDialog("MemberLoginDialog",s,r,Oe()),We.closeCustomAuthenticationDialogs(!0)})),async showSignUpDialog(e=!0,i="fullscreen",t=!1){if(De&&(null==S?void 0:S.isPopupPage(De)))return We.showCustomAuthenticationDialog(De,t);const o="Enabled"!==E["specs.ShouldPassCaptchaVerificationOnSignupSpec"]&&"Enabled"===E["specs.ShouldForceCaptchaVerificationOnSignupSpec"];return new Promise((async(n,s)=>{Fe.assignRequestAuthenticationPromise(n,s);const r={bsi:xe,displayMode:i,language:c.userLanguage,directionByLanguage:c.directionByLanguage,isCloseable:e,smCollectionId:V,biVisitorId:J(),svSession:K,metaSiteId:ie,isSocialLoginGoogleEnabled:Se,isSocialLoginFacebookEnabled:!z&&Ce,isSocialAuthSupported:ue,isEmailLoginEnabled:!z,isCommunityInstalled:q,joinCommunityCheckedByDefault:Pe,isTermsOfUseNeeded:!(!(null==we?void 0:we.enabled)||!Z.termsOfUse),isPrivacyPolicyNeeded:!(!(null==fe?void 0:fe.enabled)||!Z.privacyPolicy),isCodeOfConductNeeded:!(!(null==ye?void 0:ye.enabled)||!Z.codeOfConduct),shouldUseInvisibleCaptcha:E["specs.thunderbolt.useInvisibleCaptcha"],shouldForceCaptchaVerification:o,termsOfUseLink:Z.termsOfUse,privacyPolicyLink:Z.privacyPolicy,codeOfConductLink:Z.codeOfConduct},l={onCloseDialogCallback(){qe.hideDialog(),Ue.closingDialog("SignUpDialog",i),Fe.rejectAuthenticationRequest()},submit(e,o,s){let r;if(q){r=("boolean"==typeof s?s:s.isCommunityChecked)?y.iY.PUBLIC:y.iY.PRIVATE}const l="boolean"==typeof s||null==s?void 0:s.recaptchaToken,c="boolean"==typeof s||null==s?void 0:s.invisibleRecaptchaToken;return a.interactionStarted(y.SE.DEFAULT_SIGNUP),Ue.emailAuthSubmitClicked("SignUpDialog",i),We.register(e,o,void 0,r,void 0,t,l,c).then((e=>{a.interactionEnded(y.SE.DEFAULT_SIGNUP);const{member:i,sessionToken:o,pages:s}=e;o&&(qe.hideDialog(),n(Object.assign({member:i,sessionToken:o},t?{pages:s}:{})))})).catch((e=>{throw(0,I.fJ)(e)&&a.interactionEnded(y.SE.DEFAULT_SIGNUP),e}))},onSwitchDialogLinkClick(){We.showLoginDialog(e,i,t).then(n,(()=>{Fe.rejectAuthenticationRequest()}))},onTokenMessage(e,i,o=!1){let a;return q&&(a=o?"PUBLIC":"PRIVATE"),We.handleOauthToken(e,i,"memberLoginDialog",a,t).then((e=>{qe.hideDialog(),n(e)}))},onBackendSocialLogin:(e,i)=>We.handleSocialLoginResponse(e,i,t).then((e=>{qe.hideDialog(),n(e)})),getHostReadyPayload:()=>({visitorId:J(),svSession:K}),openCaptcha:(0,h.yT)({captcha:k,userLanguage:c.userLanguage})};Ue.loginOrSignUpDialogLoaded("SignUpDialog",i),await qe.displayDialog("SignUpDialog",r,l,Oe()),We.closeCustomAuthenticationDialogs(!0)}))},async hideAuthDialog(){console.warn("hideAuthDialog is not supported")},async showNotificationDialog(e,i,t,o=(()=>0),a=(()=>0)){const n={isCloseable:!0,title:e,description:i,okButtonText:t},s={onCloseDialogCallback(){Ue.closingDialog("NotificationDialog"),qe.hideDialog(),a()},onOkButtonClick(){qe.hideDialog(),o()}};await qe.displayDialog("NotificationDialog",n,s)},async showConfirmationEmailDialog(e,i=!0){if(E["specs.thunderbolt.rejectApprovalNeededAuthenticationRequests"])return new Promise(((t,o)=>{const a={isCloseable:!0,isSignUp:i},n={onCloseDialogCallback(){Ue.closingDialog("ConfirmationEmailDialog"),qe.hideDialog(),Fe.rejectAuthenticationRequest(),o(y.$9.CANCELED)},async onResendConfirmationEmail(){await We.resendEmailVerification(e),await We.showConfirmationEmailDialog(e,!1).catch(o)}};qe.displayDialog("ConfirmationEmailDialog",a,n)}));{const t={isCloseable:!0,isSignUp:i},o={onCloseDialogCallback(){Ue.closingDialog("ConfirmationEmailDialog"),qe.hideDialog()},async onResendConfirmationEmail(){await We.resendEmailVerification(e),await We.showConfirmationEmailDialog(e,!1)}};return qe.displayDialog("ConfirmationEmailDialog",t,o).then(I.Y_)}},async showAdminApprovalDialog(e,i){const t=await m();return E["specs.thunderbolt.rejectApprovalNeededAuthenticationRequests"]?new Promise(((o,a)=>{const n=()=>{Fe.rejectAuthenticationRequest(),a(y.$9.CANCELED)};We.showNotificationDialog("",`${t("siteMembersTranslations","SMApply_Success1",`Success! Your member ${i} request has been sent and is awaiting approval.`)} ${t("siteMembersTranslations","SMApply_Success2","The site administrator will notify you via email ({0}) once your request has been approved.")}`.replace("{0}",e),t("siteMembersTranslations","SMContainer_OK","OK"),n,n)})):We.showNotificationDialog("",`${t("siteMembersTranslations","SMApply_Success1",`Success! Your member ${i} request has been sent and is awaiting approval.`)} ${t("siteMembersTranslations","SMApply_Success2","The site administrator will notify you via email ({0}) once your request has been approved.")}`.replace("{0}",e),t("siteMembersTranslations","SMContainer_OK","OK")).then(I.Y_)},async showCustomAuthenticationDialog(e,i=!1){if(!S)throw new Error("popup unavailable");return new Promise((async(t,o)=>{Fe.assignRequestAuthenticationPromise(t,o);const a=We.registerToUserLogin((async()=>{Fe.resolveAuthenticationRequest(Object.assign({member:ke,sessionToken:Te},i?{pages:await We.authorizeMemberPagesBySignedInstance(Ie)}:{})),We.unRegisterToUserLogin(a),S.getCurrentPopupId()===e&&S.closePopupPage()}),"customAuthCbId");await Fe.openPopupPage(e,(()=>{We.unRegisterToUserLogin(a)})),qe.hideDialog()}))},async closeCustomAuthenticationDialogs(e=!1){const i=null==S?void 0:S.getCurrentPopupId();i&&[De,Ee].includes(i)&&(e&&Fe.preventCustomPopupCloseCallback(),await S.closePopupPage(),Fe.allowCustomPopupCloseCallback())},getForgotPasswordToken:()=>new URL((0,p.yF)(u)?n.requestUrl:location.href).searchParams.get("forgotPasswordToken"),shouldDisplayWelcomeDialog:()=>H&&ee,showVerificationCodeDialog:async e=>new Promise((async(i,t)=>{var o,n;Ue.siteMembersEmailConfirmationNewMembersModalLoad(),Fe.assignRequestAuthenticationPromise(i,t);const s=null==e?void 0:e.email,r={language:c.userLanguage,directionByLanguage:c.directionByLanguage,isCloseable:null===(n=null===(o=Fe.config)||void 0===o?void 0:o.isCloseable)||void 0===n||n,displayMode:"customPopup",email:s},l={onResendVerificationCodeEmail:()=>(Ue.siteMembersEmailConfirmationOnResendCodeClick(),We.register(s,e.password,e.contactInfo,e.profilePrivacyStatus,e.defaultFlow,e.returnPages,"",e.invisibleRecaptchaToken,e.emailVerification)),onCloseDialogCallback(){qe.hideDialog(),Ue.closingDialog("VerificationCode"),Fe.rejectAuthenticationRequest(),t(y.$9.CANCELED)},onSubmitCallback(o){var n;Ue.siteMembersEmailConfirmationSendCodeClick();const r={verificationId:(null===(n=null==e?void 0:e.emailVerification)||void 0===n?void 0:n.verificationId)||"",otp:o||""};return We.register(s,e.password,e.contactInfo,e.profilePrivacyStatus,e.defaultFlow,e.returnPages,"",e.invisibleRecaptchaToken,r).then((e=>{a.interactionEnded(y.SE.VERIFICATION_CODE),qe.hideDialog(),i(e)})).catch((e=>{throw(0,I.fJ)(e)&&a.interactionEnded(y.SE.VERIFICATION_CODE),t(e),e}))}};qe.displayDialog("VerificationCodeDialog",r,l)})),appWillMount(){switch(new URL(n.requestUrl).searchParams.get("showDialog")){case"MemberLoginDialog":We.showLoginDialog();break;case"SignUpDialog":We.showSignUpDialog();break;case"RequestPasswordResetDialog":We.promptForgotPassword();break;case"ResetPasswordDialog":We.showResetPasswordDialog("faketoken");break;case"WelcomeDialog":We.showWelcomeDialog();break;case"NoPermissionsToPageDialog":We.showNoPermissionsToPageDialog();break;case"NotificationDialog":We.showNotificationDialog("title","description","ok");break;case"ConfirmationEmailDialog":We.showConfirmationEmailDialog("fakemember");break;case"VerificationCodeDialog":We.showVerificationCodeDialog({email:"testEmail@test.com",password:"",profilePrivacyStatus:"PUBLIC",returnPages:!1,defaultFlow:!1,recaptchaToken:"",invisibleRecaptchaToken:"false"})}},pageWillUnmount({pageId:e}){[De,Ee].includes(e)||qe.hideDialog()},getSocialAuthComponentProps:()=>(0,I.IO)({config:e,viewerModel:n,sessionManager:s,bsiManager:L,handleOauthToken:We.handleOauthToken,handleSocialLoginResponse:We.handleSocialLoginResponse,isSocialAuthSupported:de,captcha:k,userLanguage:c.userLanguage})};return t.update((()=>({shouldShowRenderingBlockingDialogs:()=>!(!We.getForgotPasswordToken()&&!We.shouldDisplayWelcomeDialog()),showRenderingBlockingDialogs:()=>{const e=We.getForgotPasswordToken();return e?We.showResetPasswordDialog(e):We.shouldDisplayWelcomeDialog()?We.showWelcomeDialog():void 0}}))),We}));var M=t(13487),N=t(46450),U=t(11986);const $=(0,o.ff)([E.n9],(e=>({getTpaHandlers(){const i=async(i,t,o)=>{var a,n,s;const r=await e.getMemberDetails();return r?(null===(a=o.appClientSpecMapData)||void 0===a?void 0:a.isWixTPA)?{attributes:{firstName:null!==(n=r.firstName)&&void 0!==n?n:"",lastName:null!==(s=r.lastName)&&void 0!==s?s:"",privacyStatus:r.profilePrivacyStatus},name:r.memberName,email:r.loginEmail,id:r.id,owner:r.owner,status:r.status}:{id:r.id,owner:r.owner,status:r.status}:null},t=async(i,t={})=>{var o,a;const{member:n}=await e.promptLogin({mode:t.mode,modal:t.modal});return{attributes:{firstName:null!==(o=n.firstName)&&void 0!==o?o:"",lastName:null!==(a=n.lastName)&&void 0!==a?a:"",privacyStatus:n.profilePrivacyStatus},name:n.memberName,email:n.loginEmail,id:n.id,owner:n.owner,status:n.status}};return{currentMember:i,smCurrentMember:i,logOutCurrentMember:(0,U.u)(["site"],((i,t)=>{e.logout(null==t?void 0:t.url)})),requestLogin:(0,U.u)(["site"],t),smRequestLogin:(0,U.u)(["site"],t)}}}))),j=(0,o.ff)([E.n9,(0,o.t6)(a.$e,E.u2),r.xP],((e,{componentIds:i},t)=>({name:"site-members-components",pageWillMount(){const o=i.reduce(((i,t)=>{const o=e.getSocialAuthComponentProps();return Object.assign(Object.assign({},i),{[t]:o})}),{});t.update(o)}}))),q=(0,o.ff)([(0,o.t6)(a.Wf,E.u2)],(e=>({handle:async i=>{const{shouldShowRenderingBlockingDialogs:t,showRenderingBlockingDialogs:o}=e.get();return t()?(o(),null):i}}))),F=e=>{e(E.n9,M.j.AppWillMountHandler,M.j.AppDidMountHandler).to(_),e(v.BD.BlockingDialogs).to(q)},B=e=>{e(N.go).to($),e(M.j.PageWillMountHandler).to(j),e(M.j.PageWillUnmountHandler).to((0,o.ff)([E.n9],(e=>({pageWillUnmount:i=>e.pageWillUnmount(i)}))))}},61885:function(e,i,t){"use strict";t.d(i,{aG:function(){return n},yT:function(){return s},O1:function(){return l},NU:function(){return c}});const o="LOGIN",a="SIGNUP",n=({experiments:e,openCaptchaDialog:i})=>(t,n)=>{const s="Enabled"!==e["specs.ShouldPassCaptchaVerificationOnSignupSpec"]&&"Enabled"===e["specs.ShouldForceCaptchaVerificationOnSignupSpec"]&&t===a,l="Enabled"===e["specs.ShouldForceCaptchaVerificationOnLoginSpec"]&&t===o,c=s||l,u=async e=>{if(void 0===e&&c)return e=await i(),u(e);try{return await n(e)}catch(t){if(r(t)&&(e=await i().catch((()=>{throw t}))||void 0))return u(e);throw t}};return u()},s=({captcha:e,userLanguage:i})=>()=>e?new Promise(((t,o)=>{e.close(),e.open({onVerified:i=>{e.close(),t(i)},onClose:()=>{e.close(),o()},language:i})})):Promise.resolve(""),r=e=>{var i,t,o,a;const n=(null===(i=null==e?void 0:e.details)||void 0===i?void 0:i.errorcode)||(null===(t=null==e?void 0:e.details)||void 0===t?void 0:t.errorCode)||(null===(a=null===(o=null==e?void 0:e.details)||void 0===o?void 0:o.applicationError)||void 0===a?void 0:a.code);return c.includes(n)},l={SM_CAPTCHA_REQUIRED:"-19971",SM_CAPTCHA_INVALID:"-19970",REQUEST_THROTTLED:"-19959"},c=[l.SM_CAPTCHA_REQUIRED,l.SM_CAPTCHA_INVALID,l.REQUEST_THROTTLED]},89534:function(e,i,t){"use strict";t.d(i,{C:function(){return o},t:function(){return a}});const o=Symbol("CaptchaApi"),a="CAPTCHA_DIALOG_ROOT_COMP"}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/siteMembers.d1689c21.chunk.min.js.map